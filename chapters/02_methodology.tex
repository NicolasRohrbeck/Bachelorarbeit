\chapter{Methodology \label{ch:methodology}}
This chapter presents the hard- and software used in the \ac{ADS} as it was prepared for the junior flight of \ac{SETH}. The methodology covers a mixture of work done by senior scientists of the \ac{IEAP} and our own contributions. Most notable eternal contribution comes from Dr. Stephan Böttcher who did the \ac{PCB} design, wrote the \ac{FPGA} code and soldered the example which was used. 

\section{Data Acquisition \label{sec:meth:data_acquisition}}
During the flight multiple instruments are used to acquire data: an accelerometer and magnetometer for the attitude determination and three 10$\times$20\,mm$^2$ silicon \acfp{SSD}. The \acp{SSD} are used as a scientific payload to determine particle count rates and observe \acp{GCR}.

The program \verb|rpirena.py| is used to stream the data coming from the \ac{FPGA} to the SD\:Card or the \verb|Asterix| server. This program was written by Dr. Stephan Böttcher and is running on a Raspberry Pi Zero. As of March 14$^\mathrm{th}$ 2025 the program code can be found under \verb|asterix/home/subversion/stephan/solo/eda/cospi/host|. The program writes different event lines into a file, depending on the packet header. The important lines for this thesis are \verb|ID| and \verb|C64| lines. The \verb|ID| lines contain the information from the accelerometer and magnetometer, each entry separated with a white space. The first entry is the line identifier "ID", followed by the packet header "4805" or "12C5" in hexadecimal. After this, the number of words in the line minus one (for the packet header) is printed "132" by design. After this, the information words from accelerometer and Magnetometer begin. An example of the line is given below.
\begin{lstlisting}
ID 4805 132 
\end{lstlisting}

The \verb|ID| 

\section{Data Interpretation \label{sec:meth:data_interpretation}}
To interpret the data, the script \verb|att_eval.py| is used.

\section{Calibration Technique \label{sec:meth:calibration_technique}}
The calibration relies only on the magnitude of the vector field to be measured. For the magnetic field this is:
\begin{align}
    B& = \sqrt{B_x^2+B_y^2+B_z^2} \\
    \iff B^2& = B_x^2+B_y^2+B_z^2 
    \label{eq:regular_sphere}
\end{align}

If we assume the measurement to be affected by a scale factor $sf$ and a linear offset, we get the following three equations. Note that the field to be measured is given without a subscript.
\begin{align}
    B_{x,\ meas} &= sf_x\cdot B_x+x_0 \label{eq:bx}\\
    B_{y,\ meas} &= sf_y\cdot B_y+y_0 \label{eq:by}\\
    B_{z,\ meas} &= sf_z\cdot B_z+z_0 \label{eq:bz}
\end{align}

Solving for $B_{x,y,z}$ in each of eqs. \eqref{eq:bx} - \eqref{eq:bz} and plugging this into eq. \eqref{eq:regular_sphere} gives us the formula for a sphere shifted off the origin by $x_0$, $y_0$, and $z_0$. The radius of the sphere is also irregular because of the scale factors.
\begin{equation}
    B^2=\left(\frac{B_x-x_0}{sf_x}\right)^2 + \left(\frac{B_y-y_0}{sf_y}\right)^2 + \left(\frac{B_z-z_0}{sf_z}\right)^2
    \label{eq:irregular_sphere}
\end{equation}


\section{Reflection on Methodology \label{sec:meth:reflection_methodology}}